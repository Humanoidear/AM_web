---
import i18next, { t } from "i18next";
import { localizePath } from "astro-i18next";
import HeaderLink from "./HeaderLink.astro";
import LanguageDropdown from "./LanguageDropdown.astro";

const { isIndex, isWork } = Astro.props;
---

<header
  class="p-8 sm:px-12 w-full h-20 z-50 fixed transition-transform transition-timing-function: cubic-bezier(0, 0, 0, 1);"
  id="header"
>
  <nav class="flex flex-row items-center justify-between gap-5">
    <div class="flex flex-row items-center gap-6">
      <h2>
        <a href={localizePath("/")}
          ><img src="/img/am.svg" alt="Go home" width="70px" /></a
        >
      </h2>
    </div>
    <div
      class={`flex-row items-center gap-6 internal-links sm:flex transition-all hidden`}
    >
      <div
        class="mr-6 flex-row items-center gap-9 internal-links sm:flex hidden"
      >
        <HeaderLink href={localizePath("/about")}
          >{t("header.about")}</HeaderLink
        >
        <HeaderLink href={localizePath("/work")}>{t("header.work")}</HeaderLink>
        <HeaderLink href={localizePath("/#contact")}
          >{t("header.contact")}</HeaderLink
        >
      </div>
      <LanguageDropdown />
      <button class="btn" id="menuIcon" onclick="toggleDropdown();">
        <img
          src="https://unpkg.com/pixelarticons@1.8.1/svg/chevron-down.svg"
          alt="Socials"
          class="invert w-8 h-8 opacity-60 hover:opacity-100 transition-all"
        />
      </button>
      <div
        id="dropdown"
        class="top-20 right-12 dropdown-content hidden pointer-events-none mt-0 p-1 flex flex-col items-end gap-3 z-10 transition-all absolute"
      >
        <a
          href="https://x.com/alexmalvehy"
          class="flex flex-row gap-3 items-center justify-end opacity-0 -translate-y-[20px] transition-all"
        >
          <div class="h-10 -mt-3 flex flex-col items-end gap-0">
            <p class="p-0 m-0 leading-tight">Twitter</p>
            <p
              style="padding:0px; margin:0px; text-align:right; font-size:18px; opacity:30%;"
            >
              @alexmalvehy
            </p>
          </div>
          <img
            src="/img/SVG_socials/twitter.svg"
            class="h-6 invert hover:opacity-100 opacity-30 transition-all"
          /></a
        >
        <a
          href="https://www.behance.net/alexmalvehy"
          class="flex flex-row gap-3 items-center justify-end opacity-0 -translate-y-[20px] transition-all"
        >
          <div class="h-10 -mt-3 flex flex-col items-end gap-0">
            <p class="p-0 m-0 leading-tight">Behance</p>
            <p
              style="padding:0px; margin:0px; text-align:right; font-size:18px; opacity:30%;"
            >
              /alexmalvehy
            </p>
          </div>
          <img
            src="/img/SVG_socials/behance.svg"
            class="h-6 invert hover:opacity-100 opacity-30 transition-all"
          /></a
        >
        <a
          href="https://www.youtube.com/c/Al3xitu"
          class="flex flex-row gap-3 items-center justify-end opacity-0 -translate-y-[20px] transition-all"
        >
          <div class="h-10 -mt-3 flex flex-col items-end gap-0">
            <p class="p-0 m-0 leading-tight">YouTube</p>
            <p
              style="padding:0px; margin:0px; text-align:right; font-size:18px; opacity:30%;"
            >
              @al3xitu
            </p>
          </div>
          <img
            src="/img/SVG_socials/youtube.svg"
            class="h-6 invert hover:opacity-100 opacity-30 transition-all"
          /></a
        >
        <a
          href="https://www.instagram.com/alexmalvehy/"
          class="flex flex-row gap-3 items-center justify-end opacity-0 -translate-y-[20px] transition-all"
        >
          <div class="h-10 -mt-3 flex flex-col items-end gap-0">
            <p class="p-0 m-0 leading-tight">Instagram</p>
            <p
              style="padding:0px; margin:0px; text-align:right; font-size:18px; opacity:30%;"
            >
              @alexmalvehy
            </p>
          </div>
          <img
            src="/img/SVG_socials/instagram.svg"
            class="h-6 invert hover:opacity-100 opacity-30 transition-all"
          /></a
        >
        <a
          href="https://www.linkedin.com/company/alexmalvehy/"
          class="flex flex-row gap-3 items-center justify-end opacity-0 -translate-y-[20px] transition-all"
        >
          <div class="h-10 -mt-3 flex flex-col items-end gap-0">
            <p class="p-0 m-0 leading-tight">LinkedIn</p>
            <p
              style="padding:0px; margin:0px; text-align:right; font-size:18px; opacity:30%;"
            >
              Alex Malvehy
            </p>
          </div>
          <img
            src="/img/SVG_socials/linkedin.svg"
            class="h-6 invert hover:opacity-100 opacity-30 transition-all"
          /></a
        >
      </div>

      <script is:inline data-astro-rerun>
        function toggleDropdown() {
          const dropdown = document.getElementById("dropdown");
          const links = dropdown.querySelectorAll("a");
          const menuIcon = document.getElementById("menuIcon");

          if (dropdown.classList.contains("hidden")) {
            dropdown.classList.remove("hidden");
            dropdown.classList.remove("pointer-events-none");
            menuIcon.style.transform = "rotate(90deg)";

            links.forEach((link, index) => {
              setTimeout(() => {
                link.style.opacity = "1";
                link.style.transform = "translateY(0)";
              }, index * 100);
            });
          } else {
            links.forEach((link, index) => {
              setTimeout(() => {
                link.style.opacity = "0";
                link.style.transform = "translateY(-20px)";
              }, index * 100);
            });

            setTimeout(() => {
              dropdown.classList.add("hidden");
              dropdown.classList.add("pointer-events-none");
              menuIcon.style.transform = "rotate(0deg)";
            }, links.length * 100);
          }
        }
      </script>
    </div>
  </nav>
</header>

<script define:vars={{ isIndex, isWork }}>
  const header = document.getElementById("header");
  if (isIndex) {
    header.classList.add("-translate-y-20");
    window.addEventListener("scroll", () => {
      if (window.scrollY > 100) {
        header.classList.remove("-translate-y-20");
      } else {
        header.classList.add("-translate-y-20");
      }
    });
  } else {
    header.classList.remove("-translate-y-20");
  }

  if (isWork) {
    header.style.background = "transparent";
    window.addEventListener("scroll", () => {
      if (window.scrollY > 100) {
        header.classList.add("with-before");
      } else {
        header.classList.remove("with-before");
      }
    });
  } else {
    header.classList.add("with-before");
  }
</script>

<style>
  header.with-before::before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(
      180deg,
      rgba(0, 0, 0, 1) 0%,
      rgba(0, 0, 0, 0.6) 50%,
      rgba(0, 0, 0, 0) 100%
    );
    filter: blur(4px);
    transform: scale(150%);
    pointer-events: none;
    z-index: -1;
    opacity: 1;
    transition: opacity 0.5s ease-in-out;
  }

  header:not(.with-before)::before {
    opacity: 0;
  }

  a:hover div {
    transform: translate(0px, 0);
    opacity: 1;
    transition: 0.2s;
  }
  a:hover img {
    opacity: 1;
    transition: opacity 0.2s;
  }
  a div {
    transform: translate(20px, 0);
    opacity: 0;
    transition: 0.2s;
  }
  #dropdown {
    display: flex;
    flex-direction: column;
    align-items: flex-end;
  }
  #dropdown a {
    opacity: 0;
    transform: translateY(-20px);
  }
  #dropdown.show a {
    opacity: 1;
    transform: translateY(0);
  }
  .animatein {
    animation: auto linear animatein both;
    animation-timeline: view();
    animation-range: exit;
  }
  @keyframes animatein {
    0% {
      opacity: 0;
      transform: translateY(20px);
    }
    100% {
      opacity: 1;
      transform: translateY(0);
    }
  }
</style>
